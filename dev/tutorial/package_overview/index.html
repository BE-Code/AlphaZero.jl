<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Package Overview · AlphaZero</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">AlphaZero</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Guided Tour</span><ul><li><a class="tocitem" href="../alphazero_intro/">Introduction to AlphaZero</a></li><li class="is-active"><a class="tocitem" href>Package Overview</a></li><li><a class="tocitem" href="../connect_four/">Training a Connect Four Agent</a></li></ul></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../../reference/params/">Training Parameters</a></li><li><a class="tocitem" href="../../reference/game_interface/">Game Interface</a></li><li><a class="tocitem" href="../../reference/mcts/">MCTS</a></li><li><a class="tocitem" href="../../reference/network/">Network Interface</a></li><li><a class="tocitem" href="../../reference/networks_library/">Networks Library</a></li><li><a class="tocitem" href="../../reference/player/">Players</a></li><li><a class="tocitem" href="../../reference/memory/">Memory Buffer</a></li><li><a class="tocitem" href="../../reference/environment/">Environment</a></li><li><a class="tocitem" href="../../reference/benchmark/">Benchmark</a></li><li><a class="tocitem" href="../../reference/reports/">Training Reports</a></li><li><a class="tocitem" href="../../reference/ui/">User Interface</a></li></ul></li><li><span class="tocitem">Contributing</span><ul><li><a class="tocitem" href="../../contributing/guide/">Contribution Guide</a></li><li><a class="tocitem" href="../../contributing/add_game/">Adding New Games</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Guided Tour</a></li><li class="is-active"><a href>Package Overview</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Package Overview</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jonathan-laurent/AlphaZero.jl/blob/master/docs/src/tutorial/package_overview.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Package-Overview-1"><a class="docs-heading-anchor" href="#Package-Overview-1">Package Overview</a><a class="docs-heading-anchor-permalink" href="#Package-Overview-1" title="Permalink"></a></h1><p>The philosophy of this project is to provide an implementation of AlphaZero that is simple enough to be widely accessible for students and researchers, while also being sufficiently powerful and fast to enable meaningful experiments on limited computing resources.</p><p>On this page, we describe some key features of AlphaZero.jl:</p><ul><li>An asynchronous MCTS implementation</li><li>A series of opt-in optimizations to increase training efficiency</li><li>Generic interfaces for games and neural networks</li><li>A simple user interface to get started quickly and diagnose problems</li></ul><h3 id="async_mcts-1"><a class="docs-heading-anchor" href="#async_mcts-1">Asynchronous MCTS</a><a class="docs-heading-anchor-permalink" href="#async_mcts-1" title="Permalink"></a></h3><p>A key MCTS optimization that is implemented in AlphaZero.jl is to allow several workers to explore the search tree asynchronously. Doing so requires a bit of care to ensure that all workers are not always exploring the same branch simultaneously, which is done by introducing a <a href="https://blogs.oracle.com/developers/lessons-from-alpha-zero-part-5:-performance-optimization">virtual loss</a> mechanism.</p><p>Perhaps surprisingly, our implementation is fully sequential and workers are <em>not</em> scheduled on multiple cores. However, the real gain comes from enabling game positions to be evaluated by the neural network in large batches, thereby maximizing the GPU utilization.</p><p>We plot below the resulting speedup on self-play data generation for our <a href="../connect_four/#connect_four-1">connect four agent</a> as a function of the number of asynchronous workers. Using <code>scripts/profile/async_mcts.jl</code> on our machine (a desktop computer with an Intel Core i5 9600K processor and an 8GB Nvidia RTX 2070 GPU), we obtain a 25x speedup for 128 workers:</p><p><img src="../../assets/img/connect-four/async-profiling/mcts_speed.png" alt="Async speedup"/></p><p>Note that the virtual loss induces an exploration bias that can become significant when the number of workers gets too close to the total number of MCTS simulations performed. For this reason, we only use 32 workers in our <a href="../connect_four/#connect_four-1">connect four experiment</a> and settle for a 14x speedup.</p><p>We implemented MCTS (both synchronous and asynchronous) in a standalone <a href="../../reference/mcts/#mcts-1">module</a>. Thanks to Julia&#39;s great support for <a href="https://docs.julialang.org/en/v1/manual/control-flow/#man-tasks-1">coroutines</a>, adding support for asynchronicity to a vanilla implementation only required some minor refactoring and a few dozens lines of additional code.</p><h3 id="Training-Optimizations-1"><a class="docs-heading-anchor" href="#Training-Optimizations-1">Training Optimizations</a><a class="docs-heading-anchor-permalink" href="#Training-Optimizations-1" title="Permalink"></a></h3><p>AlphaZero.jl has out-of-the-box support for many of the optimizations introduced in <a href="https://medium.com/oracledevs/lessons-from-implementing-alphazero-7e36e9054191">Oracle&#39;s series</a> and also implements new ones. These include:</p><ul><li>Position averaging</li><li>Memory buffer with growing window</li><li>Cyclical learning rates</li><li>Symmetry-based data augmentation and game randomization</li></ul><p>All these optimizations are documented in the <a href="../../reference/params/#params-1">Training Parameters</a> section of the manual.</p><h3 id="Game-Interface-1"><a class="docs-heading-anchor" href="#Game-Interface-1">Game Interface</a><a class="docs-heading-anchor-permalink" href="#Game-Interface-1" title="Permalink"></a></h3><p>You can use AlphaZero.jl on the game of your choice by simply implementing the <a href="../../reference/game_interface/#game_interface-1">Game Interface</a>. Currently, there is support for two-players, symmetric (the rules are the same for both players), zero-sum games with finite action spaces and perfect information. We plan to handle more kinds of games in the future.</p><p>When adding support for a new game, we recommend following some <a href="../../contributing/add_game/#add_game-1">conventions</a> to ensure that it works properly with all helper scripts in the <code>scripts</code> directory.</p><h3 id="Network-Interface-1"><a class="docs-heading-anchor" href="#Network-Interface-1">Network Interface</a><a class="docs-heading-anchor-permalink" href="#Network-Interface-1" title="Permalink"></a></h3><p>AlphaZero.jl is agnostic to the choice of deep learning framework and allows you to plug any neural network that implements the <a href="../../reference/network/#network_interface-1">Network Interface</a>. For convenience, we provide a <a href="../../reference/networks_library/#networks_library-1">library</a> of standard networks based on Knet. Right now, it features templates for two-headed <a href="../../reference/networks_library/#simplenet-1">multi-layer perceptrons</a> and <a href="../../reference/networks_library/#conv_resnet-1">convolutional resnets</a>.</p><h3 id="User-Interface-and-Utilities-1"><a class="docs-heading-anchor" href="#User-Interface-and-Utilities-1">User Interface and Utilities</a><a class="docs-heading-anchor-permalink" href="#User-Interface-and-Utilities-1" title="Permalink"></a></h3><p>AlphaZero.jl comes with <em>batteries included</em>. It features a simple <a href="../../reference/ui/#ui-1">user interface</a> along with utilities for session management, logging, profiling, benchmarking and model exploration.</p><ul><li>A <a href="../../reference/ui/#session-1">session management</a> system makes it easy to interrupt and resume training.</li><li>An <a href="../../reference/ui/#explorer-1">interactive command interpreter</a> can be used to explore the behavior of AlphaZero agents.</li><li>Reports are generated automatically after each training iteration to help diagnosing problems and tuning hyperparameters. An extensive documentation of collected metrics can be found in <a href="../../reference/reports/#reports-1">Training Reports</a> and <a href="../../reference/benchmark/#benchmark-1">Benchmarks</a>.</li></ul><p>Finally, because the user interface is implemented separately from the core algorithm, it can be extended or <a href="../../contributing/guide/#improve_ui-1">replaced</a> easily.</p><div>
<img src="../../assets/img/connect-four/plots/benchmark_won_games.png" width="24%" />
<img src="../../assets/img/connect-four/plots/arena.png" width="24%" />
<img src="../../assets/img/connect-four/plots/exploration_depth.png" width="24%" />
<img src="../../assets/img/connect-four/plots/entropies.png" width="24%" />
<img src="../../assets/img/connect-four/plots/loss.png" width="24%" />
<img src="../../assets/img/connect-four/plots/loss_per_stage.png" width="24%"/>
<img src="../../assets/img/connect-four/plots/iter_perfs/1.png" width="24%"/>
<img src="../../assets/img/connect-four/plots/iter_loss/1.png" width="24%" />
<img src="../../assets/img/ui-first-iter-cut.png" width="48%" />
<img src="../../assets/img/explorer.png" width="48%" />
<!--<img src="../../assets/img/connect-four/plots/iter_summary/1.png" width="24%" />-->
</div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../alphazero_intro/">« Introduction to AlphaZero</a><a class="docs-footer-nextpage" href="../connect_four/">Training a Connect Four Agent »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Saturday 2 May 2020 22:13">Saturday 2 May 2020</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
