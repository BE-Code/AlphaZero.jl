<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Networks Library · AlphaZero</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">AlphaZero</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="../../tutorial/alphazero_intro/">Introduction to AlphaZero</a></li><li><a class="tocitem" href="../../tutorial/connect_four/">Learning to Play Connect Four</a></li></ul></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../params/">Training Parameters</a></li><li><a class="tocitem" href="../game_interface/">Game Interface</a></li><li><a class="tocitem" href="../mcts/">MCTS</a></li><li><a class="tocitem" href="../network/">Network Interface</a></li><li class="is-active"><a class="tocitem" href>Networks Library</a><ul class="internal"><li><a class="tocitem" href="#Knet-Utilities-1"><span>Knet Utilities</span></a></li><li><a class="tocitem" href="#Networks-Library-1"><span>Networks Library</span></a></li></ul></li><li><a class="tocitem" href="../player/">Players</a></li><li><a class="tocitem" href="../memory/">Memory Buffer</a></li><li><a class="tocitem" href="../environment/">Environment</a></li><li><a class="tocitem" href="../benchmark/">Benchmark</a></li><li><a class="tocitem" href="../session/">Sessions</a></li><li><a class="tocitem" href="../reports/">Training Reports</a></li></ul></li><li><span class="tocitem">Contributing</span><ul><li><a class="tocitem" href="../../contributing/guide/">Contributions Guide</a></li><li><a class="tocitem" href="../../contributing/add_game/">Adding New Games</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Reference</a></li><li class="is-active"><a href>Networks Library</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Networks Library</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jonathan-laurent/AlphaZero.jl/blob/master/docs/src/reference/networks_library.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="networks_library-1"><a class="docs-heading-anchor" href="#networks_library-1">Networks Library</a><a class="docs-heading-anchor-permalink" href="#networks_library-1" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="AlphaZero.KNets" href="#AlphaZero.KNets"><code>AlphaZero.KNets</code></a> — <span class="docstring-category">Module</span></header><section><div><p>This module provides utilities to build neural networks with Knet, along with a library of standard architectures.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jonathan-laurent/AlphaZero.jl/blob/ba3bc45f30ad55d06bd87d79def930994fc16514/src/networks/knet.jl#LL1-L4">source</a></section></article><h2 id="Knet-Utilities-1"><a class="docs-heading-anchor" href="#Knet-Utilities-1">Knet Utilities</a><a class="docs-heading-anchor-permalink" href="#Knet-Utilities-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="AlphaZero.KNets.KNetwork" href="#AlphaZero.KNets.KNetwork"><code>AlphaZero.KNets.KNetwork</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">KNetwork{Game} &lt;: AbstractNetwork{Game}</code></pre><p>Abstract type for neural networks implemented using the <em>Knet</em> framework.</p><ul><li>Subtypes are expected to be expressed as the composition of Flux-like layers that implement a functor interface through functions <code>children</code> and <code>mapchildren</code>.</li><li>A custom implementation of <code>regularized_params_</code> must also be implemented for layers containing parameters that are subject to regularization.</li></ul><p>Provided that the above holds, <code>KNetwork</code> implements the full network interface with the following exceptions: <a href="../network/#AlphaZero.Network.HyperParams"><code>Network.HyperParams</code></a>, <a href="../network/#AlphaZero.Network.hyperparams"><code>Network.hyperparams</code></a>, <a href="../network/#AlphaZero.Network.forward"><code>Network.forward</code></a> and <a href="../network/#AlphaZero.Network.on_gpu"><code>Network.on_gpu</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jonathan-laurent/AlphaZero.jl/blob/ba3bc45f30ad55d06bd87d79def930994fc16514/src/networks/knet.jl#LL52-L68">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AlphaZero.KNets.TwoHeadNetwork" href="#AlphaZero.KNets.TwoHeadNetwork"><code>AlphaZero.KNets.TwoHeadNetwork</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">TwoHeadNetwork{Game} &lt;: KNetwork{G}</code></pre><p>An abstract type for two-head neural networks implemented with Knet.</p><p>Subtypes are assumed to have the following fields: <code>hyper</code>, <code>common</code>, <code>vhead</code> and <code>phead</code>. Based on those, an implementation is provided for <a href="../network/#AlphaZero.Network.hyperparams"><code>Network.hyperparams</code></a>, <a href="../network/#AlphaZero.Network.forward"><code>Network.forward</code></a> and <a href="../network/#AlphaZero.Network.on_gpu"><code>Network.on_gpu</code></a>, leaving only <a href="../network/#AlphaZero.Network.HyperParams"><code>Network.HyperParams</code></a> to be implemented.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jonathan-laurent/AlphaZero.jl/blob/ba3bc45f30ad55d06bd87d79def930994fc16514/src/networks/knet.jl#LL134-L144">source</a></section></article><h2 id="Networks-Library-1"><a class="docs-heading-anchor" href="#Networks-Library-1">Networks Library</a><a class="docs-heading-anchor-permalink" href="#Networks-Library-1" title="Permalink"></a></h2><h3 id="Convolutional-ResNet-1"><a class="docs-heading-anchor" href="#Convolutional-ResNet-1">Convolutional ResNet</a><a class="docs-heading-anchor-permalink" href="#Convolutional-ResNet-1" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="AlphaZero.KNets.ResNet" href="#AlphaZero.KNets.ResNet"><code>AlphaZero.KNets.ResNet</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">ResNet{Game} &lt;: TwoHeadNetwork{Game}</code></pre><p>The convolutional residual network architecture that is used in the original AlphaGo Zero paper.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jonathan-laurent/AlphaZero.jl/blob/ba3bc45f30ad55d06bd87d79def930994fc16514/src/networks/architectures/resnet.jl#LL41-L46">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AlphaZero.KNets.ResNetHP" href="#AlphaZero.KNets.ResNetHP"><code>AlphaZero.KNets.ResNetHP</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">ResNetHP</code></pre><p>Hyperparameters for the convolutional resnet architecture.</p><table><tr><th style="text-align: left">Parameter</th><th style="text-align: left">Type</th><th style="text-align: left">Default</th></tr><tr><td style="text-align: left"><code>num_blocks</code></td><td style="text-align: left"><code>Int</code></td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><code>num_filters</code></td><td style="text-align: left"><code>Int</code></td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><code>conv_kernel_size</code></td><td style="text-align: left"><code>Tuple{Int, Int}</code></td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><code>num_policy_head_filters</code></td><td style="text-align: left"><code>Int</code></td><td style="text-align: left"><code>2</code></td></tr><tr><td style="text-align: left"><code>num_value_head_filters</code></td><td style="text-align: left"><code>Int</code></td><td style="text-align: left"><code>1</code></td></tr><tr><td style="text-align: left"><code>batch_norm_momentum</code></td><td style="text-align: left"><code>Float32</code></td><td style="text-align: left"><code>0.6f0</code></td></tr></table><p>The trunk of the two-head network consists of <code>num_blocks</code> consecutive blocks. Each block features two convolutional layers with <code>num_filters</code> filters and with kernel size <code>conv_kernel_size</code>. Note that both kernel dimensions must be odd.</p><p>During training, the network is evaluated in training mode on the whole dataset to compute the loss before it is switched to test model, using big batches. Therefore, it makes sense to use a high batch norm momentum (put a lot of weight on the latest measurement).</p><p><strong>AlphaGo Zero Parameters</strong></p><p>The network in the original paper from Deepmind features 20 blocks with 256 filters per convolutional layer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaLang/julia/blob/2d5741174ce3e6a394010d2e470e4269ca54607f/base/#L0-L28">source</a></section></article><h3 id="Simple-Network-1"><a class="docs-heading-anchor" href="#Simple-Network-1">Simple Network</a><a class="docs-heading-anchor-permalink" href="#Simple-Network-1" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="AlphaZero.KNets.SimpleNet" href="#AlphaZero.KNets.SimpleNet"><code>AlphaZero.KNets.SimpleNet</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">SimpleNet{Game} &lt;: TwoHeadNetwork{Game}</code></pre><p>A simple two-headed architecture with only dense layers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jonathan-laurent/AlphaZero.jl/blob/ba3bc45f30ad55d06bd87d79def930994fc16514/src/networks/architectures/simplenet.jl#LL26-L30">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AlphaZero.KNets.SimpleNetHP" href="#AlphaZero.KNets.SimpleNetHP"><code>AlphaZero.KNets.SimpleNetHP</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">SimpleNetHP</code></pre><p>Hyperparameters for the simplenet architecture.</p><table><tr><th style="text-align: left">Parameter</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left"><code>width :: Int</code></td><td style="text-align: left">Number of neurons on each dense layer</td></tr><tr><td style="text-align: left"><code>depth_common :: Int</code></td><td style="text-align: left">Number of dense layers in the trunk</td></tr><tr><td style="text-align: left"><code>depth_phead = 1</code></td><td style="text-align: left">Number of hidden layers in the actions head</td></tr><tr><td style="text-align: left"><code>depth_vhead = 1</code></td><td style="text-align: left">Number of hidden layers in the value  head</td></tr><tr><td style="text-align: left"><code>use_batch_norm = false</code></td><td style="text-align: left">Use batch normalization between each layer</td></tr><tr><td style="text-align: left"><code>batch_norm_momentum = 0.6f0</code></td><td style="text-align: left">Momentum of batch norm statistics updates</td></tr></table></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaLang/julia/blob/2d5741174ce3e6a394010d2e470e4269ca54607f/base/#L0-L13">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../network/">« Network Interface</a><a class="docs-footer-nextpage" href="../player/">Players »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 23 March 2020 01:30">Monday 23 March 2020</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
